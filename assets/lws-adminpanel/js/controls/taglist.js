(function($){$.widget("custom.lws_taglist",{_create:function(){var me=this;this.container=this.element.parent();this.valueList=this.element.val().split(";");for(var i=0;i<this.valueList.length;i++){if(this.valueList[i]=="")this.valueList.splice(i,1)}this._createStructure();this._fillList();this.container.on("click",".lws-tag-remove",this._bind(this._delTag,this));this.container.on("click",".lws-taglist-btadd",this._bind(this._addTags,this));this.container.on("keypress",".lws-taglist-input",function(e){if(e.which==13){me.container.find(".lws-taglist-btadd").trigger("click")}})},_bind:function(fn,me){return function(){return fn.apply(me,arguments)}},_createStructure:function(){$("<div>",{class:"lws-taglist-wrapper"}).append($("<div>",{class:"lws-taglist-top"}).append($("<input>",{type:"text",class:"lws-input lws-taglist-input"})).append($("<a>",{class:"lws-taglist-btadd",html:this.element.data("btlabel")}))).append($("<div>",{class:"lws-taglist-bottom"})).appendTo(this.container)},_fillList:function(){var me=this;var listContainer=this.container.find(".lws-taglist-bottom");listContainer.empty();for(var i=0;i<this.valueList.length;i++){$("<div>",{class:"lws-tag-wrapper","data-index":i}).append($("<div>",{class:"lws-tag-text",html:this.valueList[i]})).append($("<a>",{class:"lws-tag-remove lws-icon lws-icon-cross"})).appendTo(listContainer)}},_delTag:function(event){var theTag=$(event.currentTarget).parent();this.valueList.splice(theTag.data("index"),1);theTag.remove();this._updateList()},_addTags:function(event){var newValueList=this.valueList.concat($(event.currentTarget).parent().find(".lws-taglist-input").val().split(","));this.valueList=newValueList.filter(function(elem,index,self){return index===self.indexOf(elem)});$(event.currentTarget).parent().find(".lws-taglist-input").val("");this._fillList();this._updateList()},_updateList:function(){var tagList="";for(var i=0;i<this.valueList.length;i++){tagList+=this.valueList[i]+";"}tagList=tagList.slice(0,-1);this.element.val(tagList)}})})(jQuery);jQuery(function($){$(".lws_taglist").lws_taglist()});
